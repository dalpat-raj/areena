"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[5556],{1498:function(e,s,a){a.d(s,{Z:function(){return h}});a(2791);var r=a(1087),n=a(8820),i=a(3853),d=a(6856),t=a(4651),c=a(458),o=a(7692),l=a(8617),u=a(1213),v=a(184),h=function(e){var s=e.active;return(0,v.jsxs)("div",{className:"dashboardSidebar__main",children:[(0,v.jsx)("div",{className:1===s?"dashboardSidebar__row active":"dashboardSidebar__row",children:(0,v.jsx)(r.rU,{to:"/shop-dashboard",children:(0,v.jsxs)("div",{className:"sidebar__header",children:[(0,v.jsx)("div",{className:"icon",children:(0,v.jsx)(u.toC,{})}),(0,v.jsx)("div",{className:"text",children:"Dashboard"})]})})}),(0,v.jsx)("div",{className:2===s?"dashboardSidebar__row active":"dashboardSidebar__row",children:(0,v.jsx)(r.rU,{to:"/shop-dashboard/orders",children:(0,v.jsxs)("div",{className:"sidebar__header",children:[(0,v.jsx)("div",{className:"icon",children:(0,v.jsx)(i.x8h,{})}),(0,v.jsx)("div",{className:"text",children:"All Orders"})]})})}),(0,v.jsx)("div",{className:3===s?"dashboardSidebar__row active":"dashboardSidebar__row",children:(0,v.jsx)(r.rU,{to:"/shop-dashboard/products",children:(0,v.jsxs)("div",{className:"sidebar__header",children:[(0,v.jsx)("div",{className:"icon",children:(0,v.jsx)(i.zFh,{})}),(0,v.jsx)("div",{className:"text",children:"All Products"})]})})}),(0,v.jsx)("div",{className:4===s?"dashboardSidebar__row active":"dashboardSidebar__row",children:(0,v.jsx)(r.rU,{to:"/shop-dashboard-create-product",children:(0,v.jsxs)("div",{className:"sidebar__header",children:[(0,v.jsx)("div",{className:"icon",children:(0,v.jsx)(n.A6B,{})}),(0,v.jsx)("div",{className:"text",children:"Create Product"})]})})}),(0,v.jsx)("div",{className:5===s?"dashboardSidebar__row active":"dashboardSidebar__row",children:(0,v.jsx)(r.rU,{to:"/shop-dashboard-events",children:(0,v.jsxs)("div",{className:"sidebar__header",children:[(0,v.jsx)("div",{className:"icon",children:(0,v.jsx)(d.HUb,{})}),(0,v.jsx)("div",{className:"text",children:"All Events"})]})})}),(0,v.jsx)("div",{className:6===s?"dashboardSidebar__row active":"dashboardSidebar__row",children:(0,v.jsx)(r.rU,{to:"/shop-dashboard-create-event",children:(0,v.jsxs)("div",{className:"sidebar__header",children:[(0,v.jsx)("div",{className:"icon",children:(0,v.jsx)(t.CI7,{})}),(0,v.jsx)("div",{className:"text",children:"Create Event"})]})})}),(0,v.jsx)("div",{className:7===s?"dashboardSidebar__row active":"dashboardSidebar__row",children:(0,v.jsx)(r.rU,{to:"/shop-dashboard-withdraw-money",children:(0,v.jsxs)("div",{className:"sidebar__header",children:[(0,v.jsx)("div",{className:"icon",children:(0,v.jsx)(c.Zkf,{})}),(0,v.jsx)("div",{className:"text",children:"Withdraw Money"})]})})}),(0,v.jsx)("div",{className:8===s?"dashboardSidebar__row active":"dashboardSidebar__row",children:(0,v.jsx)(r.rU,{to:"/shop-dashboard-messages",children:(0,v.jsxs)("div",{className:"sidebar__header",children:[(0,v.jsx)("div",{className:"icon",children:(0,v.jsx)(o.kK8,{})}),(0,v.jsx)("div",{className:"text",children:"Shop Inbox"})]})})}),(0,v.jsx)("div",{className:9===s?"dashboardSidebar__row active":"dashboardSidebar__row",children:(0,v.jsx)(r.rU,{to:"/shop-dashboard-coupon-code",children:(0,v.jsxs)("div",{className:"sidebar__header",children:[(0,v.jsx)("div",{className:"icon",children:(0,v.jsx)(n.RcH,{})}),(0,v.jsx)("div",{className:"text",children:"Discount Codes"})]})})}),(0,v.jsx)("div",{className:10===s?"dashboardSidebar__row active":"dashboardSidebar__row",children:(0,v.jsx)(r.rU,{to:"/shop-dashboard-refund",children:(0,v.jsxs)("div",{className:"sidebar__header",children:[(0,v.jsx)("div",{className:"icon",children:(0,v.jsx)(l.xkh,{})}),(0,v.jsx)("div",{className:"text",children:"Refunds"})]})})}),(0,v.jsx)("div",{className:11===s?"dashboardSidebar__row active":"dashboardSidebar__row",children:(0,v.jsx)(r.rU,{to:"/shop-dashboard-delivery-area",children:(0,v.jsxs)("div",{className:"sidebar__header",children:[(0,v.jsx)("div",{className:"icon",children:(0,v.jsx)(o.rdY,{})}),(0,v.jsx)("div",{className:"text",children:"Your Delivery Area"})]})})}),(0,v.jsx)("div",{className:12===s?"dashboardSidebar__row active":"dashboardSidebar__row",children:(0,v.jsx)(r.rU,{to:"/shop-dashboard-setting",children:(0,v.jsxs)("div",{className:"sidebar__header",children:[(0,v.jsx)("div",{className:"icon",children:(0,v.jsx)(c.H$w,{})}),(0,v.jsx)("div",{className:"text",children:"Setting"})]})})})]})}},5556:function(e,s,a){a.r(s),a.d(s,{default:function(){return N}});var r=a(4165),n=a(5861),i=a(3433),d=a(9439),t=a(2791),c=a(1498),o=a(7425),l=a(860),u=a(4651),v=a(9434),h=a(7689),x=a(5759),m=a(1243),_=a(1608),j=a(184),p=(0,_.ZP)("http://localhost:4000/",{transports:["websocket"]}),f=function(e){var s,a=e.data,i=e.index,c=e.setOpen,o=e.setCurrentChat,l=e.me,u=e.setUserData,v=e.online,_=e.setActiveStatus,p=e.isLoading,f=(0,t.useState)([]),b=(0,d.Z)(f,2),N=b[0],g=b[1],w=(0,h.s0)(),Z=(0,t.useState)(0),S=(0,d.Z)(Z,2),k=(S[0],S[1]);return(0,t.useEffect)((function(){_(v);var e=a.members.find((function(e){return e!==l})),s=function(){var s=(0,n.Z)((0,r.Z)().mark((function s(){var a,n;return(0,r.Z)().wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return s.prev=0,s.next=3,m.Z.get("/api/v2/user-info/".concat(e));case 3:a=s.sent,n=a.data,g(n.user),s.next=11;break;case 8:s.prev=8,s.t0=s.catch(0),console.log(s.t0);case 11:case"end":return s.stop()}}),s,null,[[0,8]])})));return function(){return s.apply(this,arguments)}}();s()}),[l,a,v,_]),(0,j.jsx)("div",{className:"message__box",onClick:function(){return k(i)||(e=a._id,w("/shop-dashboard-messages/?".concat(e)),void c(!0))||o(a)||u(N)||_(v);var e},children:(0,j.jsxs)("div",{className:"".concat("message__row"),children:[(0,j.jsxs)("div",{className:"imgBox",children:[(0,j.jsx)("img",{src:"".concat(x.M,"/").concat(null===N||void 0===N?void 0:N.avatar),alt:"aaa"}),v&&(0,j.jsx)("div",{className:"active"})]}),(0,j.jsxs)("div",{className:"name__message",children:[(0,j.jsx)("p",{children:null===N||void 0===N?void 0:N.name}),(0,j.jsxs)("span",{children:[p||(null===a||void 0===a?void 0:a.lastMessageId)===(null===N||void 0===N?void 0:N._id)?(null===N||void 0===N||null===(s=N.name)||void 0===s?void 0:s.split(" ")[0])+": ":"You:"," ",null===a||void 0===a?void 0:a.lastMessage]})]})]})})},b=function(e){var s=e.scrollRef,a=e.setOpen,r=e.newMessage,n=e.setNewMessage,i=e.sendMessageHandler,d=e.messages,t=e.sellerId,c=e.userData,v=e.activeStatus,h=e.handleImageUpload,m=e.images;return(0,j.jsx)("div",{className:"seller__inbox__main",children:(0,j.jsxs)("div",{className:"seller__inbox__column",children:[(0,j.jsxs)("div",{className:"seller__row",children:[(0,j.jsxs)("div",{className:"imgBox",children:[(0,j.jsx)("img",{src:"".concat(x.M,"/").concat(null===c||void 0===c?void 0:c.avatar),alt:"raj"}),v&&(0,j.jsx)("div",{className:"active"})]}),(0,j.jsxs)("div",{className:"name__message",children:[(0,j.jsx)("p",{children:null===c||void 0===c?void 0:c.name}),(0,j.jsx)("span",{children:v?"Active Now":""})]}),(0,j.jsx)("div",{className:"back__icon",children:(0,j.jsx)(o.TPM,{onClick:function(){return a(!1)}})})]}),(0,j.jsx)("div",{className:"messages__box",children:d&&d.map((function(e,a){return(0,j.jsxs)("div",{className:"".concat(e.sender===t?"message__row row__2":"message__row"),ref:s,children:[(0,j.jsx)("div",{className:"message__content",children:e.images?(0,j.jsx)("img",{src:"".concat(x.M,"/").concat(null===e||void 0===e?void 0:e.images),alt:m+"rajraj"}):(0,j.jsx)("p",{children:e.text})}),(0,j.jsx)("div",{className:"time__ago"})]},a)}))}),(0,j.jsx)("div",{className:"send__messages",children:(0,j.jsxs)("form",{onSubmit:i,children:[(0,j.jsxs)("div",{className:"input__box side__input",children:[(0,j.jsx)("label",{htmlFor:"files",children:(0,j.jsx)(l.jRL,{size:23})}),(0,j.jsx)("input",{type:"file",id:"files",onChange:h})]}),(0,j.jsx)("div",{className:"input__box center__input",children:(0,j.jsx)("input",{type:"text",placeholder:"type message here...",value:r,onChange:function(e){return n(e.target.value)}})}),(0,j.jsxs)("div",{className:"input__box side__input",children:[(0,j.jsx)("label",{htmlFor:"sends",children:(0,j.jsx)(u.NQj,{size:25})}),(0,j.jsx)("input",{type:"submit",id:"sends"})]})]})})]})})},N=function(){var e=(0,v.v9)((function(e){return e.seller})),s=e.seller,a=e.isLoading,o=(0,t.useState)([]),l=(0,d.Z)(o,2),u=l[0],h=l[1],x=(0,t.useState)(null),_=(0,d.Z)(x,2),N=_[0],g=_[1],w=(0,t.useState)(),Z=(0,d.Z)(w,2),S=Z[0],k=Z[1],M=(0,t.useState)([]),I=(0,d.Z)(M,2),U=I[0],y=I[1],C=(0,t.useState)(null),D=(0,d.Z)(C,2),A=D[0],E=D[1],R=(0,t.useState)(""),H=(0,d.Z)(R,2),L=H[0],O=H[1],P=(0,t.useState)([]),F=(0,d.Z)(P,2),z=F[0],B=F[1],Y=(0,t.useState)(!1),K=(0,d.Z)(Y,2),Q=K[0],T=K[1],V=(0,t.useState)(),W=(0,d.Z)(V,2),$=W[0],q=W[1],G=(0,t.useState)(!1),J=(0,d.Z)(G,2),X=J[0],ee=J[1],se=(0,t.useRef)(null);(0,t.useEffect)((function(){p.on("getMessage",(function(e){g({sender:e.senderId,text:e.text,createdAt:Date.now()})}))}),[]),(0,t.useEffect)((function(){N&&(null===S||void 0===S?void 0:S.members.includes(N.sender))&&y((function(e){return[].concat((0,i.Z)(e),[N])}))}),[N,S]),(0,t.useEffect)((function(){var e=function(){var e=(0,n.Z)((0,r.Z)().mark((function e(){var a;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,m.Z.get("/api/v2/get-all-conversation-seller/".concat(null===s||void 0===s?void 0:s._id),{withCredentials:!0});case 3:a=e.sent,h(a.data.conversation),e.next=9;break;case 7:e.prev=7,e.t0=e.catch(0);case 9:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();e()}),[s,U]),(0,t.useEffect)((function(){if(s){var e=null===s||void 0===s?void 0:s._id;p.emit("addUser",e),p.on("getUsers",(function(e){B(e)}))}}),[s]);var ae=function(e){var a=e.members.find((function(e){return e!==(null===s||void 0===s?void 0:s._id)}));return!!z.find((function(e){return e.userId===a}))};(0,t.useEffect)((function(){var e=function(){var e=(0,n.Z)((0,r.Z)().mark((function e(){var s;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,m.Z.get("/api/v2/get-all-messages/".concat(null===S||void 0===S?void 0:S._id));case 3:s=e.sent,y(s.data.messages),e.next=9;break;case 7:e.prev=7,e.t0=e.catch(0);case 9:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();e()}),[S]);var re=function(){var e=(0,n.Z)((0,r.Z)().mark((function e(a){var n,d;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.preventDefault(),n={sender:null===s||void 0===s?void 0:s._id,text:L,conversationId:null===S||void 0===S?void 0:S._id},d=S.members.find((function(e){return e.id!==(null===s||void 0===s?void 0:s._id)})),p.emit("sendMessage",{senderId:null===s||void 0===s?void 0:s._id,receiverId:d,text:L}),e.prev=4,""===L){e.next=8;break}return e.next=8,m.Z.post("/api/v2/create-new-message",n).then((function(e){y([].concat((0,i.Z)(U),[e.data.message])),ne()})).catch((function(e){console.log(e)}));case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(4),console.log(e.t0);case 13:case"end":return e.stop()}}),e,null,[[4,10]])})));return function(s){return e.apply(this,arguments)}}(),ne=function(){var e=(0,n.Z)((0,r.Z)().mark((function e(){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p.emit("updateLastMessage",{lastMessage:L,lastMessageId:null===s||void 0===s?void 0:s._id}),e.next=3,m.Z.put("/api/v2/update-last-message/".concat(null===S||void 0===S?void 0:S._id),{lastMessage:L,lastMessageId:null===s||void 0===s?void 0:s._id}).then((function(e){O("")})).catch((function(e){console.log(e)}));case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ie=function(){var e=(0,n.Z)((0,r.Z)().mark((function e(s){var a;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=s.target.files[0],q(a),de(a);case 3:case"end":return e.stop()}}),e)})));return function(s){return e.apply(this,arguments)}}(),de=function(){var e=(0,n.Z)((0,r.Z)().mark((function e(a){var n,d;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=new FormData).append("images",a),n.append("sender",null===s||void 0===s?void 0:s._id),n.append("text",L),n.append("conversationId",null===S||void 0===S?void 0:S._id),d=S.members.find((function(e){return e!==s._id})),p.emit("sendMessage",{senderId:null===s||void 0===s?void 0:s._id,receiverId:d,images:a}),e.prev=7,e.next=10,m.Z.post("/api/v2/create-new-message",n).then((function(e){q(),y([].concat((0,i.Z)(U),[e.data.message])),te()})).catch((function(e){console.log(e)}));case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(7),console.log(e.t0.response.data.error);case 15:case"end":return e.stop()}}),e,null,[[7,12]])})));return function(s){return e.apply(this,arguments)}}(),te=function(){var e=(0,n.Z)((0,r.Z)().mark((function e(){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.Z.put("/api/v2/update-last-message/".concat(S._id),{lastMessage:"Photo",lastMessageId:null===s||void 0===s?void 0:s._id});case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,t.useEffect)((function(){var e;null===(e=se.current)||void 0===e||e.scrollIntoView({beahaviour:"smooth"})}),[U]),(0,j.jsx)("div",{className:"dashboard__container",children:(0,j.jsx)("div",{className:"container",children:(0,j.jsxs)("div",{className:"dashboard__row",children:[(0,j.jsx)("div",{className:"col__2 dashboard__sidebar",children:(0,j.jsx)(c.Z,{active:8})}),(0,j.jsx)("div",{className:"col__2",children:(0,j.jsxs)("div",{className:"inbox__main",children:[!X&&(0,j.jsxs)("div",{className:"message__container",children:[(0,j.jsx)("div",{className:"heading",children:(0,j.jsx)("h2",{children:"All Messages"})}),u&&u.map((function(e,r){return(0,j.jsx)(f,{data:e,index:r,setOpen:ee,setCurrentChat:k,me:s._id,setUserData:E,userData:A,online:ae(e),setActiveStatus:T,isLoading:a},r)}))]}),X&&(0,j.jsx)(b,{setOpen:ee,newMessage:L,setNewMessage:O,sendMessageHandler:re,messages:U,sellerId:s._id,userData:A,activeStatus:Q,scrollRef:se,setMessages:y,handleImageUpload:ie,images:$})]})})]})})})}}}]);
//# sourceMappingURL=5556.33f0b12b.chunk.js.map